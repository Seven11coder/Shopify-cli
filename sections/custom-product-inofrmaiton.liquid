{{ 'nitro-product-showcase.css' | asset_url | stylesheet_tag }}

<section
  class="nitro-product-showcase"
  style="background-color: {{ section.settings.background_color }}; padding: {{ section.settings.padding_top }}px 0 {{ section.settings.padding_bottom }}px;"
  data-section-id="{{ section.id }}"
  data-product-id="{{ product.id }}">

  <div class="nitro-showcase-container">
    <div class="nitro-product-grid">

      <!-- Product Gallery -->
      <div class="nitro-gallery-wrapper">
        <div
          class="nitro-main-gallery"
          data-nitro-main-slider
          data-section-id="{{ section.id }}">
          {% if product.media.size > 0 %}
            {% for media in product.media limit: 8 %}
              <div class="nitro-gallery-cell">
                {% if media.media_type == 'image' %}
                  <img
                    src="{{ media | img_url: 'master' }}"
                    alt="{{ media.alt | escape }}"
                    loading="lazy">
                {% endif %}
              </div>
            {% endfor %}
          {% else %}
            <div class="nitro-gallery-cell">
              {{ 'product-1' | placeholder_svg_tag: 'nitro-placeholder-img' }}
            </div>
          {% endif %}
        </div>

        <div
          class="nitro-thumb-gallery"
          data-nitro-thumb-slider
          data-section-id="{{ section.id }}">
          {% if product.media.size > 0 %}
            {% for media in product.media limit: 8 %}
              <div class="nitro-thumb-cell">
                {% if media.media_type == 'image' %}
                  <img
                    src="{{ media | img_url: '150x150' }}"
                    alt="{{ media.alt | escape }}"
                    loading="lazy">
                {% endif %}
              </div>
            {% endfor %}
          {% else %}
            {% for i in (1..4) %}
              <div class="nitro-thumb-cell">
                {{ 'product-1' | placeholder_svg_tag: 'nitro-placeholder-thumb' }}
              </div>
            {% endfor %}
          {% endif %}
        </div>
      </div>

      <!-- Product Information -->
      <div class="nitro-product-info">
        <div class="nitro-product-header">
          <h1 class="nitro-product-title">
            {{ product.title | default: "Nitro Cold Brew Coffee" }}
          </h1>
          {% if product.metafields.custom.subtitle %}
            <p class="nitro-product-subtitle">{{ product.metafields.custom.subtitle }}</p>
          {% endif %}
          <div class="nitro-product-description">
            {{ product.description | truncate: 150 }}
          </div>
        </div>

        <div class="nitro-price-section">
          <div class="nitro-price-display">
            <span class="price-item" id="main-price">${{ product.price | divided_by: 100.0 | round: 2 }}</span>
            <span class="price-per-can" id="price-note">12 Cans</span>
          </div>
        </div>

        {% if product.metafields.custom.caffeine_content or product.metafields.custom.calories %}
          <div class="nitro-stats-grid">
            {% if product.metafields.custom.caffeine_content %}
              <div class="nitro-stat">
                <span class="nitro-stat-number">{{ product.metafields.custom.caffeine_content | default: "150 mg" }}</span>
                <span class="nitro-stat-label">Caffeine Content (per can)</span>
              </div>
            {% endif %}
            {% if product.metafields.custom.calories %}
              <div class="nitro-stat">
                <span class="nitro-stat-number">{{ product.metafields.custom.calories | default: "80" }}</span>
                <span class="nitro-stat-label">Calories (per can)</span>
              </div>
            {% endif %}
          </div>
        {% endif %}

        <!-- Variant Selection -->
        <div class="nitro-variant-section">
          <div class="nitro-tabs">
            <button class="nitro-tab active" data-tab="flavors">Our Flavors</button>
            <button class="nitro-tab" data-tab="variety">Variety Packs</button>
          </div>

          <div class="nitro-variants-grid" id="flavors-content">
            {% if product.variants.size > 1 %}
              {% for variant in product.variants %}
                <div
                  class="nitro-variant-item {% if variant == product.selected_or_first_available_variant %}selected{% endif %}"
                  data-variant-id="{{ variant.id }}"
                  data-variant-price="{{ variant.price }}">
                  <div class="nitro-variant-item-img-cont">
                    {% if variant.featured_image %}
                      <img src="{{ variant.featured_image | img_url: 'master' }}" alt="{{ variant.title }}">
                    {% else %}
                      <img src="{{ product.featured_image | img_url: 'master' }}" alt="{{ variant.title }}">
                    {% endif %}
                    <div class="nitro-variant-item-mask"></div>
                  </div>
                  <span class="nitro-variant-name">{{ variant.title }}</span>
                </div>
              {% endfor %}
            {% else %}
              <!-- Default flavors if no variants -->
              <div class="nitro-variant-item selected" data-variant-id="{{ product.selected_or_first_available_variant.id }}">
                <img src="{{ product.featured_image | img_url: '80x80' }}" alt="Nitro Flat White">
                <span class="nitro-variant-name">Nitro Flat White</span>
              </div>
              <div class="nitro-variant-item" data-variant-id="{{ product.selected_or_first_available_variant.id }}">
                <img src="{{ product.featured_image | img_url: '80x80' }}" alt="Nitro Cafe Latte">
                <span class="nitro-variant-name">Nitro Cafe Latte</span>
              </div>
              <div class="nitro-variant-item" data-variant-id="{{ product.selected_or_first_available_variant.id }}">
                <img src="{{ product.featured_image | img_url: '80x80' }}" alt="Nitro Caramel Latte">
                <span class="nitro-variant-name">Nitro Caramel Latte</span>
              </div>
            {% endif %}
          </div>

          <div class="nitro-variants-grid hidden" id="variety-content">
            <div class="nitro-variant-item">
              <img src="{{ product.featured_image | img_url: '80x80' }}" alt="Variety Pack">
              <span class="nitro-variant-name">Mixed Variety Pack</span>
            </div>
          </div>
        </div>

        <!-- Purchase Options -->
        <div class="nitro-purchase-section">
          <h3 class="nitro-section-title">One Time Purchase</h3>
          <div class="nitro-purchase-options">
            <label class="nitro-option">
              <input
                type="radio"
                name="purchase_type"
                value="onetime-6"
                data-quantity="6"
                data-subscription="false">
              <span class="nitro-option-content">
                <span class="nitro-option-price" id="onetime-6-price">$24.95</span>
                <span class="nitro-option-note">6 Cans</span>
              </span>
            </label>
            <label class="nitro-option">
              <input
                type="radio"
                name="purchase_type"
                value="onetime-12"
                data-quantity="12"
                data-subscription="false"
                checked>
              <span class="nitro-option-content">
                <span class="nitro-option-price" id="onetime-12-price">$46.95</span>
                <span class="nitro-option-note">12 Cans</span>
              </span>
            </label>
          </div>

          <h3 class="nitro-section-title">
            Subscribe & Save 10%
            <span class="nitro-badge">Most Popular</span>
          </h3>
          <div class="nitro-purchase-options">
            <label class="nitro-option">
              <input
                type="radio"
                name="purchase_type"
                value="subscription-6"
                data-quantity="6"
                data-subscription="true">
              <span class="nitro-option-content">
                <span class="nitro-option-price" id="subscription-6-price">$20.95</span>
                <span class="nitro-option-original" id="subscription-6-original">$24.95</span>
                <span class="nitro-option-note">6 Cans</span>
              </span>
            </label>
            <label class="nitro-option">
              <input
                type="radio"
                name="purchase_type"
                value="subscription-12"
                data-quantity="12"
                data-subscription="true">
              <span class="nitro-option-content">
                <span class="nitro-option-price" id="subscription-12-price">$40.95</span>
                <span class="nitro-option-original" id="subscription-12-original">$46.95</span>
                <span class="nitro-option-note">12 Cans</span>
              </span>
            </label>
          </div>

          <div class="nitro-delivery-info">
            <span>Delivered every 4 weeks</span>
            <select id="delivery-frequency" style="margin-left: 10px;">
              <option value="4">4 weeks</option>
              <option value="6">6 weeks</option>
              <option value="8">8 weeks</option>
            </select>
            <div class="nitro-benefits">
              <span>✓ Free shipping</span>
              <span>✓ Cancel anytime</span>
              <span>✓ Save 10% on Every Delivery</span>
            </div>
          </div>
        </div>

        <!-- Product Form -->
        <product-form class="nitro-product-form">
          <form
            action="/cart/add"
            method="post"
            enctype="multipart/form-data"
            class="product-form"
            data-product-form>
            <input
              type="hidden"
              name="id"
              value="{{ product.selected_or_first_available_variant.id }}"
              id="variant-id">
            <input
              type="hidden"
              name="quantity"
              value="12"
              id="quantity">
            <input
              type="hidden"
              name="properties[_subscription]"
              value=""
              id="subscription">
            <input
              type="hidden"
              name="properties[_frequency]"
              value=""
              id="frequency">

            <div class="product-form__buttons">
              <button
                type="submit"
                name="add"
                class="btn product-form__cart-submit"
                id="add-to-cart">
                <span>Add to Cart</span>
              </button>
              {{ form | payment_button }}
            </div>
          </form>
        </product-form>
      </div>
    </div>
  </div>
</section>

<script>
  window.productData = {
    id: {{ product.id }},
    price: {{ product.price }},
    variants: {{ product.variants | json }},
    selectedVariant: {{ product.selected_or_first_available_variant.id }}
  };
</script>

<script src="{{ 'nitro-product-showcase.js' | asset_url }}" defer></script>

{% schema %}
  {
    "name": "Nitro Product Showcase",
    "settings": [
      {
        "type": "color",
        "id": "background_color",
        "label": "Background Color",
        "default": "#ffffff"
      }, {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Top Padding",
        "default": 40
      }, {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Bottom Padding",
        "default": 40
      }
    ],
    "presets": [
      {
        "name": "Nitro Product Showcase"
      }
    ]
  }
{% endschema %}